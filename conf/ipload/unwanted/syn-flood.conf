# SYN Flood (too many attempts at connecting in a row)

[rule::clear_syn_flood]
table = filter
chain = unwanted
section = early_content
recent = check synflood 60s reap
action = NONE
description = "Clear the SYN flood list of old entries."

[rule::syn_flood]
table = filter
chain = unwanted
section = early_content
after = clear_syn_flood
protocol = tcp
state = new
recent = set synflood, check synflood 100 60s
action = CALL add_to_denylist
description = "Prevent SYN flood DDoS attacks--half-opened TCP connections consume resources."

[rule::syn_flood_size]
table = mangle
chain = PREROUTING
protocol = tcp
state = new | tcpmss ! 536-65535
action = DROP
description = "Block new TCP packets that are too small."

# vim: syntax=dosini
